# 7.22工作日报

10:40/19:40

10:40-11:20	调试串口绘图，方便调试pid
11:20-12:00	roll方向的P调参
14:00-15:00	roll方向的PD调参
15:00-16:00	pitch方向的P调参
16:30-17:00	编写console调参函数
17:00-18:00	调试位置式PID函数的bug，导出各项大小
18:00-19:40	调参pitch和roll方向的PID参数，并两者同时执行

指向数组的指针使用：

double *p, array[10];
p = array;
*(p+i)与array[i]一致

作为函数传递的数组时，需要定义为静态变量

之后可以把角度单位转换单独封装出来为函数

安全角度范围：均20度

电池自然掉电有点严重

先调roll，但误差符号反了（可以由此讨论出小跳动作，左右偏跳）
没给反，抖动很严重
猜测抖动来自装配误差

| 对象         | 数值      | 效果                                                         |
| ------------ | --------- | ------------------------------------------------------------ |
| roll k_p     | 1         | 超调严重，不收敛                                             |
|              | 0.1       | 几乎没有反馈                                                 |
|              | 0.5       | 超调严重，不收敛                                             |
|              | 0.3       | 超调，收敛振荡，可以变成左右跳（其实不是，这不是平衡的超调） |
|              | 0.2       | 不调整                                                       |
|              | 0.25      | 不调整                                                       |
|              | 0.2       |                                                              |
| roll k_p k_d | 0.2, 0.1  |                                                              |
|              | 0.2, 0.3  | 抖动减弱，但是还有                                           |
|              | 0.25，0.5 |                                                              |
|              | 0.25，0.7 | 推荐                                                         |
| pitch k_p    | 0.5       | 电池撞到地面，P太大                                          |
|              | 0.3       | 挺好的，如果抖动比较大是会振荡                               |

考虑到坐标系变换，控制量的目标项应该是世界系与足面系的差值，之后才有pid项
但其实影响不大，只要I项起来了就行了



| 对象         | 数值                                 | 效果                                     |
| ------------ | ------------------------------------ | ---------------------------------------- |
| pitch k_d    | 1                                    | 太大                                     |
|              | 0.2                                  | 不错，但有小振荡                         |
|              | 0.2,0,0.2                            |                                          |
|              | 0.25,0,0                             | good                                     |
|              | 0.25,0,0.2                           |                                          |
|              | 0.25,0.01,0.2                        |                                          |
|              | 0.25,0.02,0.2                        |                                          |
|              | 0.25,0.05,0.2                        |                                          |
|              | 0.25,0.03,0.2                        | 最佳                                     |
| roll         | 0.25,0,0                             |                                          |
|              | 0.25,0,0.2                           |                                          |
|              | 0.25,0,0.1                           |                                          |
|              | 0.25,0,0                             |                                          |
|              | 0.25,0.001,0                         | 振荡                                     |
|              | 0.25.0.01,0.1                        | 些许振荡                                 |
|              | 0.25,0.02,0.2                        | 振荡太大                                 |
|              | 0.25,0.02,0.1                        |                                          |
|              | 0.25,0.01,0.1                        |                                          |
|              | 0.2,0.01,0.1                         |                                          |
| pitch & roll | 0.2, 0.01, 0.1;<br />0.25, 0.02, 0.2 | 响应比较慢，有点振荡；两个方向需要再调调 |

arduino也可以多线程，在setup里加就行了
